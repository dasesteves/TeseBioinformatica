-- =====================================================
-- VERIFICAR OUTRAS TABELAS DE MOVIMENTOS
-- =====================================================

-- 1. VERIFICAR SE O ARTIGO EXISTE NA TABELA DE MEDICAMENTOS
SELECT 
    CODIGO,
    DESC_C,
    STOCK_ATUAL
FROM PCE.PRF_MEDICAMENTOS
WHERE CODIGO = 'FA10040790'
   OR UPPER(DESC_C) LIKE '%MACROGOL%';

-- 2. VERIFICAR MOVIMENTOS NA TABELA PRF_PRESC_MOV
SELECT * FROM (
    SELECT 
        CODIGO,
        DESC_C,
        DOSE,
        TO_CHAR(DTA_INI, 'DD/MM/YYYY') AS DATA_INICIO,
        TO_CHAR(DTA_FIM, 'DD/MM/YYYY') AS DATA_FIM,
        ESTADO
    FROM PCE.PRF_PRESC_MOV
    WHERE CODIGO = 'FA10040790'
       OR CODIGO LIKE '%10040790%'
    ORDER BY DTA_INI DESC
) t WHERE ROWNUM <= 10;

-- 3. VERIFICAR NA TABELA PRF_PRESC_MOV_F (MOVIMENTOS FARMÁCIA)
SELECT * FROM (
    SELECT 
        ID_PRESC,
        EPISODIO,
        MODULO,
        CODIGO,
        TO_CHAR(DTA_MOV, 'DD/MM/YYYY HH24:MI') AS DATA_MOVIMENTO,
        QTD_DISPENSADA
    FROM PCE.PRF_PRESC_MOV_F
    WHERE CODIGO = 'FA10040790'
       OR CODIGO LIKE '%10040790%'
    ORDER BY DTA_MOV DESC
) t WHERE ROWNUM <= 10;

-- 4. VERIFICAR TABELA PRF_PRESC_MOV_FDET (DETALHES)
SELECT * FROM (
    SELECT 
        ID_PRESC,
        CODIGO_MED,
        DESCR_MED,
        QTD_DISPENSADA,
        TO_CHAR(DTA_MOV, 'DD/MM/YYYY') AS DATA
    FROM PCE.PRF_PRESC_MOV_FDET
    WHERE CODIGO_MED = 'FA10040790'
       OR CODIGO_MED LIKE '%10040790%'
       OR UPPER(DESCR_MED) LIKE '%MACROGOL%'
    ORDER BY DTA_MOV DESC
) t WHERE ROWNUM <= 10;

-- 5. BUSCAR EM ARTIGOCODBARRAS
SELECT 
    ARTIGO,
    DESCRICAO,
    CODBARRAS
FROM PCE.ARTIGOCODBARRAS
WHERE ARTIGO = 'FA10040790'
   OR ARTIGO LIKE '%10040790%'
   OR UPPER(DESCRICAO) LIKE '%MACROGOL%';

-- 6. VERIFICAR TABELA MEDH_CARACTERIZACAO_V2
SELECT * FROM (
    SELECT 
        COD_PRODUTO,
        DES_PRODUTO,
        COD_LABORATORIO,
        DES_LABORATORIO
    FROM PCE.MEDH_CARACTERIZACAO_V2
    WHERE COD_PRODUTO = 'FA10040790'
       OR COD_PRODUTO LIKE '%10040790%'
       OR UPPER(DES_PRODUTO) LIKE '%MACROGOL%'
) t WHERE ROWNUM <= 10;

-- 7. VERIFICAR SE HÁ CONFIGURAÇÃO ESPECÍFICA DO SISTEMA
-- Procurar tabelas de parâmetros ou configuração
SELECT 
    table_name,
    num_rows
FROM all_tables
WHERE owner = 'PCE'
  AND (
    UPPER(table_name) LIKE '%PARAM%'
    OR UPPER(table_name) LIKE '%CONFIG%'
    OR UPPER(table_name) LIKE '%SERIE%'
    OR UPPER(table_name) LIKE '%STOCK%'
    OR UPPER(table_name) LIKE '%MOVIMENTO%'
  )
ORDER BY table_name;

-- 8. VERIFICAR ÚLTIMOS MOVIMENTOS DE QUALQUER ARTIGO FA
SELECT * FROM (
    SELECT 
        eg.CDU_CSU_ARTIGO,
        eg.CDU_CSU_DESCRICAO,
        eg.CDU_CSU_QUANTIDADE,
        TO_CHAR(ea.CDU_CSU_DATA, 'DD/MM/YYYY') AS DATA
    FROM PCE.CSU_EPENTIDADEACTOS ea
    JOIN PCE.CSU_EPENTIDADEACTOGASTOS eg 
        ON ea.CDU_CSU_ID = eg.CDU_CSU_EPISODIOENTIDADEACTOID
    WHERE eg.CDU_CSU_ARTIGO LIKE 'FA%'
    ORDER BY ea.CDU_CSU_DATA DESC
) t WHERE ROWNUM <= 20; 